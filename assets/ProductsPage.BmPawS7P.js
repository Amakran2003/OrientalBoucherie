import{j as e,f as r,g as a,X as s,m as t}from"./ui-vendor.JalVFfQ9.js";import{P as i}from"./PageHeader.NtosuRjp.js";import{r as n,e as l,f as c}from"./react-vendor.pFVYCVC2.js";import{g as o,u as d,a as g,L as m}from"./index.kDMhJFkA.js";import"./i18n-vendor.BK02QeAD.js";const x=({filters:i,onFilterChange:l,maxPrice:c,origins:o})=>{const[d,g]=n.useState(!1),m=(e,r)=>{const a=[...i.priceRange];a[r]=Number(e.target.value),l({...i,priceRange:a})};return e.jsxs("div",{className:"mb-8 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Rechercher des produits...",value:i.search,onChange:e=>{l({...i,search:e.target.value})},className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),e.jsx(r,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("button",{onClick:()=>g(!d),className:"flex items-center text-sm font-medium text-primary-600 dark:text-primary-400",children:[e.jsx(a,{className:"h-4 w-4 mr-1"}),d?"Masquer les filtres":"Afficher les filtres"]}),(i.search||i.priceRange[0]>0||i.priceRange[1]<c||null!==i.origin||"name-asc"!==i.sortBy)&&e.jsxs("button",{onClick:()=>{l({search:"",priceRange:[0,c],origin:null,sortBy:"name-asc"})},className:"flex items-center text-sm font-medium text-red-600 dark:text-red-400",children:[e.jsx(s,{className:"h-4 w-4 mr-1"}),"Effacer les filtres"]})]}),d&&e.jsxs(t.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Fourchette de prix (€)"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"number",min:0,max:i.priceRange[1],value:i.priceRange[0],onChange:e=>m(e,0),className:"w-24 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),e.jsx("span",{className:"text-gray-500",children:"à"}),e.jsx("input",{type:"number",min:i.priceRange[0],max:c,value:i.priceRange[1],onChange:e=>m(e,1),className:"w-24 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Origine"}),e.jsxs("select",{value:i.origin||"all",onChange:e=>{const r=e.target.value;l({...i,origin:"all"===r?null:r})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"all",children:"Toutes origines"}),o.map((r=>e.jsx("option",{value:r,children:r},r)))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Trier par"}),e.jsxs("select",{value:i.sortBy,onChange:e=>{l({...i,sortBy:e.target.value})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"name-asc",children:"Nom (A-Z)"}),e.jsx("option",{value:"name-desc",children:"Nom (Z-A)"}),e.jsx("option",{value:"price-asc",children:"Prix (croissant)"}),e.jsx("option",{value:"price-desc",children:"Prix (décroissant)"})]})]})]})]})]})},u=({categories:r,currentCategory:a,onCategoryChange:s})=>e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-8",children:[e.jsx("button",{onClick:()=>s(void 0),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors "+(a?"bg-gray-100 hover:bg-gray-200 text-gray-800":"bg-red-700 text-white"),children:"Tous les produits"}),r.map((r=>e.jsx("button",{onClick:()=>s(r.slug.current),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors "+(a===r.slug.current?"bg-red-700 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800"),children:r.title},r._id)))]}),p=({products:r})=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map((r=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow",children:[r.image&&e.jsx("div",{className:"h-48 overflow-hidden",children:e.jsx("img",{src:d(r.image).width(500).height(300).url(),alt:r.name,className:"w-full h-full object-cover transition-transform hover:scale-105"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:r.name}),r.isHalal&&e.jsx("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2 py-0.5 rounded",children:"Halal"})]}),r.description&&e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm mb-3 line-clamp-2",children:r.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-lg font-bold text-red-700",children:[r.price," €",e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["/",r.unit]})]}),r.origin&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Origine: ",r.origin]})]})]})]},r._id)))}),h=({message:r,onReset:a,resetButtonText:s})=>e.jsxs("div",{className:"text-center py-20",children:[e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:r}),e.jsx("button",{onClick:a,className:"mt-4 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:s})]});function y(){const{categorySlug:r}=l(),a=c(),{products:s,loading:t}=(()=>{const[e,r]=n.useState([]),[a,s]=n.useState(!0);return n.useEffect((()=>{(async()=>{s(!0);try{const e=await o();r(e)}catch(e){}finally{s(!1)}})()}),[]),{products:e,loading:a}})(),{categories:d}=g(),{filters:y,filteredProducts:b,origins:f,maxPrice:j,handleFilterChange:v,resetFilters:N}=((e,r)=>{const[a,s]=n.useState({search:"",priceRange:[0,1e3],origin:null,sortBy:"name-asc"}),t=n.useMemo((()=>{const r=new Set;return e.forEach((e=>{e.origin&&r.add(e.origin)})),Array.from(r).sort()}),[e]),i=n.useMemo((()=>{const r=e.map((e=>e.price)),a=Math.max(...r,0);return 10*Math.ceil(a/10)}),[e]);n.useEffect((()=>{i>0&&1e3===a.priceRange[1]&&s((e=>({...e,priceRange:[e.priceRange[0],i]})))}),[i]);const l=n.useMemo((()=>{let s=[...e];if(r&&(s=s.filter((e=>e.category&&"object"==typeof e.category&&null!==e.category&&"slug"in e.category&&e.category.slug&&"object"==typeof e.category.slug&&null!==e.category.slug&&"current"in e.category.slug&&e.category.slug.current===r))),a.search){const e=a.search.toLowerCase();s=s.filter((r=>{var a;return r.name.toLowerCase().includes(e)||(null==(a=r.description)?void 0:a.toLowerCase().includes(e))}))}switch(s=s.filter((e=>e.price>=a.priceRange[0]&&e.price<=a.priceRange[1])),a.origin&&(s=s.filter((e=>e.origin===a.origin))),a.sortBy){case"price-asc":s.sort(((e,r)=>e.price-r.price));break;case"price-desc":s.sort(((e,r)=>r.price-e.price));break;case"name-asc":s.sort(((e,r)=>e.name.localeCompare(r.name)));break;case"name-desc":s.sort(((e,r)=>r.name.localeCompare(e.name)))}return s}),[e,r,a]);return{filters:a,filteredProducts:l,origins:t,maxPrice:i,handleFilterChange:e=>{s(e)},resetFilters:()=>{s({search:"",priceRange:[0,i],origin:null,sortBy:"name-asc"})}}})(s,r),k=t;return e.jsxs(e.Fragment,{children:[e.jsx(i,{title:"Nos Produits",description:"Découvrez notre sélection de viandes de qualité, fraîches et préparées avec savoir-faire."}),e.jsxs("div",{className:"container-custom py-10",children:[e.jsx(u,{categories:d,currentCategory:r,onCategoryChange:e=>{a(e?`/products/${e}`:"/products")}}),e.jsx(x,{filters:y,onFilterChange:v,maxPrice:j,origins:f}),k?e.jsx(m,{}):b.length>0?e.jsx(p,{products:b}):e.jsx(h,{message:"Aucun produit trouvé avec les critères sélectionnés.",onReset:N,resetButtonText:"Réinitialiser les filtres"})]})]})}export{y as default};
