import{r as e,j as r,k as a,l as s}from"./react-core.AawETj4e.js";import{P as t}from"./PageHeader.DB7xTlsT.js";import{f as i,g as n,X as c,m as l}from"./ui-vendor.Bc24Atmp.js";import{g as o,u as d,a as g,L as m}from"./index.3MfIHNxo.js";import"./react-router.lVB7F_vc.js";import"./vendor.DmP8XtnG.js";import"./i18n-vendor.mIIe-_Aw.js";const x=({filters:a,onFilterChange:s,maxPrice:t,origins:o})=>{const[d,g]=e.useState(!1),m=(e,r)=>{const t=[...a.priceRange];t[r]=Number(e.target.value),s({...a,priceRange:t})};return r.jsxs("div",{className:"mb-8 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[r.jsxs("div",{className:"relative mb-4",children:[r.jsx("input",{type:"text",placeholder:"Rechercher des produits...",value:a.search,onChange:e=>{s({...a,search:e.target.value})},className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),r.jsx(i,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]}),r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>g(!d),className:"flex items-center text-sm font-medium text-primary-600 dark:text-primary-400",children:[r.jsx(n,{className:"h-4 w-4 mr-1"}),d?"Masquer les filtres":"Afficher les filtres"]}),(a.search||a.priceRange[0]>0||a.priceRange[1]<t||null!==a.origin||"name-asc"!==a.sortBy)&&r.jsxs("button",{onClick:()=>{s({search:"",priceRange:[0,t],origin:null,sortBy:"name-asc"})},className:"flex items-center text-sm font-medium text-red-600 dark:text-red-400",children:[r.jsx(c,{className:"h-4 w-4 mr-1"}),"Effacer les filtres"]})]}),d&&r.jsxs(l.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Fourchette de prix (€)"}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("input",{type:"number",min:0,max:a.priceRange[1],value:a.priceRange[0],onChange:e=>m(e,0),className:"w-24 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),r.jsx("span",{className:"text-gray-500",children:"à"}),r.jsx("input",{type:"number",min:a.priceRange[0],max:t,value:a.priceRange[1],onChange:e=>m(e,1),className:"w-24 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Origine"}),r.jsxs("select",{value:a.origin||"all",onChange:e=>{const r=e.target.value;s({...a,origin:"all"===r?null:r})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[r.jsx("option",{value:"all",children:"Toutes origines"}),o.map((e=>r.jsx("option",{value:e,children:e},e)))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Trier par"}),r.jsxs("select",{value:a.sortBy,onChange:e=>{s({...a,sortBy:e.target.value})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[r.jsx("option",{value:"name-asc",children:"Nom (A-Z)"}),r.jsx("option",{value:"name-desc",children:"Nom (Z-A)"}),r.jsx("option",{value:"price-asc",children:"Prix (croissant)"}),r.jsx("option",{value:"price-desc",children:"Prix (décroissant)"})]})]})]})]})]})},u=({categories:e,currentCategory:a,onCategoryChange:s})=>r.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-8",children:[r.jsx("button",{onClick:()=>s(void 0),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors "+(a?"bg-gray-100 hover:bg-gray-200 text-gray-800":"bg-red-700 text-white"),children:"Tous les produits"}),e.map((e=>r.jsx("button",{onClick:()=>s(e.slug.current),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors "+(a===e.slug.current?"bg-red-700 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800"),children:e.title},e._id)))]}),p=({products:e})=>r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:e.map((e=>r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow",children:[e.image&&r.jsx("div",{className:"h-48 overflow-hidden",children:r.jsx("img",{src:d(e.image).width(500).height(300).url(),alt:e.name,className:"w-full h-full object-cover transition-transform hover:scale-105"})}),r.jsxs("div",{className:"p-4",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsx("h3",{className:"text-xl font-semibold",children:e.name}),e.isHalal&&r.jsx("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2 py-0.5 rounded",children:"Halal"})]}),e.description&&r.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm mb-3 line-clamp-2",children:e.description}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{className:"text-lg font-bold text-red-700",children:[e.price," €",r.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["/",e.unit]})]}),e.origin&&r.jsxs("div",{className:"text-xs text-gray-500",children:["Origine: ",e.origin]})]})]})]},e._id)))}),h=({message:e,onReset:a,resetButtonText:s})=>r.jsxs("div",{className:"text-center py-20",children:[r.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:e}),r.jsx("button",{onClick:a,className:"mt-4 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:s})]});function y(){const{categorySlug:i}=a(),n=s(),{products:c,loading:l}=(()=>{const[r,a]=e.useState([]),[s,t]=e.useState(!0);return e.useEffect((()=>{(async()=>{t(!0);try{const e=await o();a(e)}catch(e){}finally{t(!1)}})()}),[]),{products:r,loading:s}})(),{categories:d}=g(),{filters:y,filteredProducts:b,origins:j,maxPrice:f,handleFilterChange:v,resetFilters:N}=((r,a)=>{const[s,t]=e.useState({search:"",priceRange:[0,1e3],origin:null,sortBy:"name-asc"}),i=e.useMemo((()=>{const e=new Set;return r.forEach((r=>{r.origin&&e.add(r.origin)})),Array.from(e).sort()}),[r]),n=e.useMemo((()=>{const e=r.map((e=>e.price)),a=Math.max(...e,0);return 10*Math.ceil(a/10)}),[r]);e.useEffect((()=>{n>0&&1e3===s.priceRange[1]&&t((e=>({...e,priceRange:[e.priceRange[0],n]})))}),[n]);const c=e.useMemo((()=>{let e=[...r];if(a&&(e=e.filter((e=>e.category&&"object"==typeof e.category&&null!==e.category&&"slug"in e.category&&e.category.slug&&"object"==typeof e.category.slug&&null!==e.category.slug&&"current"in e.category.slug&&e.category.slug.current===a))),s.search){const r=s.search.toLowerCase();e=e.filter((e=>{var a;return e.name.toLowerCase().includes(r)||(null==(a=e.description)?void 0:a.toLowerCase().includes(r))}))}switch(e=e.filter((e=>e.price>=s.priceRange[0]&&e.price<=s.priceRange[1])),s.origin&&(e=e.filter((e=>e.origin===s.origin))),s.sortBy){case"price-asc":e.sort(((e,r)=>e.price-r.price));break;case"price-desc":e.sort(((e,r)=>r.price-e.price));break;case"name-asc":e.sort(((e,r)=>e.name.localeCompare(r.name)));break;case"name-desc":e.sort(((e,r)=>r.name.localeCompare(e.name)))}return e}),[r,a,s]);return{filters:s,filteredProducts:c,origins:i,maxPrice:n,handleFilterChange:e=>{t(e)},resetFilters:()=>{t({search:"",priceRange:[0,n],origin:null,sortBy:"name-asc"})}}})(c,i),k=l;return r.jsxs(r.Fragment,{children:[r.jsx(t,{title:"Nos Produits",description:"Découvrez notre sélection de viandes de qualité, fraîches et préparées avec savoir-faire."}),r.jsxs("div",{className:"container-custom py-10",children:[r.jsx(u,{categories:d,currentCategory:i,onCategoryChange:e=>{n(e?`/products/${e}`:"/products")}}),r.jsx(x,{filters:y,onFilterChange:v,maxPrice:f,origins:j}),k?r.jsx(m,{}):b.length>0?r.jsx(p,{products:b}):r.jsx(h,{message:"Aucun produit trouvé avec les critères sélectionnés.",onReset:N,resetButtonText:"Réinitialiser les filtres"})]})]})}export{y as default};
