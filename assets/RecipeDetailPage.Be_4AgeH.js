import{j as s}from"./ui-vendor.CP3ud3pA.js";import{r as b}from"./react-core.DeQqB7wk.js";import{c as G,u as T,L as J}from"./index.BnIf7ff2.js";import{P as Q}from"./PageHeader.9n5w7q0k.js";import{u as X}from"./useFormatDate.6mQ2QUux.js";import{L as M,a as Y}from"./react-router.BIurctHh.js";import"./i18n-vendor.D6OzzxMc.js";const Z=e=>{const[t,n]=b.useState(null),[r,i]=b.useState(!0),[l,u]=b.useState(null);return b.useEffect(()=>{(async()=>{if(!e){i(!1),u("No recipe slug provided");return}i(!0),u(null);try{const x=await G(e);n(x)}catch(x){console.error("Error fetching recipe:",x),u("Failed to load recipe details")}finally{i(!1)}})()},[e]),{recipe:t,loading:r,error:l}},ee=({title:e,publishedAt:t,prepTime:n,cookTime:r,servings:i})=>{const{formatDate:l}=X();return s.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-center mb-6 pb-6 border-b border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-gray-500 mb-1",children:["Publié le ",l(t)]}),s.jsx("h1",{className:"text-3xl font-semibold",children:e})]}),s.jsxs("div",{className:"flex gap-6",children:[n&&s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Préparation"}),s.jsxs("span",{className:"font-semibold",children:[n," min"]})]}),r&&s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Cuisson"}),s.jsxs("span",{className:"font-semibold",children:[r," min"]})]}),i&&s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Personnes"}),s.jsx("span",{className:"font-semibold",children:i})]})]})]})},te=({ingredients:e})=>!e||e.length===0?null:s.jsxs("div",{className:"lg:col-span-1",children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Ingrédients"}),s.jsx("ul",{className:"space-y-2",children:e.map((t,n)=>s.jsxs("li",{className:"flex items-start",children:[s.jsx("svg",{className:"h-5 w-5 text-red-700 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"})}),s.jsxs("span",{className:"text-gray-800 dark:text-gray-200",children:[s.jsx("strong",{children:t.amount})," ",t.ingredient]})]},n))})]});function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(r){ne(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ne(e,t,n){return(t=re(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(e){var t=se(e,"string");return typeof t=="symbol"?t:t+""}function se(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I(e){return e._type==="span"&&"text"in e&&typeof e.text=="string"&&(typeof e.marks>"u"||Array.isArray(e.marks)&&e.marks.every(t=>typeof t=="string"))}function A(e){return typeof e._type=="string"&&e._type[0]!=="@"&&(!("markDefs"in e)||!e.markDefs||Array.isArray(e.markDefs)&&e.markDefs.every(t=>typeof t._key=="string"))&&"children"in e&&Array.isArray(e.children)&&e.children.every(t=>typeof t=="object"&&"_type"in t)}function U(e){return A(e)&&"listItem"in e&&typeof e.listItem=="string"&&(typeof e.level>"u"||typeof e.level=="number")}function C(e){return e._type==="@list"}function F(e){return e._type==="@span"}function K(e){return e._type==="@text"}const D=["strong","em","code","underline","strike-through"];function ie(e,t,n){if(!I(e)||!e.marks)return[];if(!e.marks.length)return[];const r=e.marks.slice(),i={};return r.forEach(l=>{i[l]=1;for(let u=t+1;u<n.length;u++){const c=n[u];if(c&&I(c)&&Array.isArray(c.marks)&&c.marks.indexOf(l)!==-1)i[l]++;else break}}),r.sort((l,u)=>le(i,l,u))}function le(e,t,n){const r=e[t],i=e[n];if(r!==i)return i-r;const l=D.indexOf(t),u=D.indexOf(n);return l!==u?l-u:t.localeCompare(n)}function ae(e){var t,n;const{children:r}=e,i=(t=e.markDefs)!=null?t:[];if(!r||!r.length)return[];const l=r.map(ie),u={_type:"@span",children:[],markType:"<unknown>"};let c=[u];for(let x=0;x<r.length;x++){const j=r[x];if(!j)continue;const k=l[x]||[];let a=1;if(c.length>1)for(a;a<c.length;a++){const m=((n=c[a])==null?void 0:n.markKey)||"",p=k.indexOf(m);if(p===-1)break;k.splice(p,1)}c=c.slice(0,a);let o=c[c.length-1];if(o){for(const m of k){const p=i==null?void 0:i.find(f=>f._key===m),d=p?p._type:m,y={_type:"@span",_key:j._key,children:[],markDef:p,markType:d,markKey:m};o.children.push(y),c.push(y),o=y}if(I(j)){const m=j.text.split(`
`);for(let p=m.length;p-- >1;)m.splice(p,0,`
`);o.children=o.children.concat(m.map(p=>({_type:"@text",text:p})))}else o.children=o.children.concat(j)}}return u.children}function oe(e,t){const n=[];let r;for(let i=0;i<e.length;i++){const l=e[i];if(l){if(!U(l)){n.push(l),r=void 0;continue}if(!r){r=_(l,i,t),n.push(r);continue}if(ce(l,r)){r.children.push(l);continue}if((l.level||1)>r.level){const u=_(l,i,t);if(t==="html"){const c=r.children[r.children.length-1],x=L(L({},c),{},{children:[...c.children,u]});r.children[r.children.length-1]=x}else r.children.push(u);r=u;continue}if((l.level||1)<r.level){const u=n[n.length-1],c=u&&P(u,l);if(c){r=c,r.children.push(l);continue}r=_(l,i,t),n.push(r);continue}if(l.listItem!==r.listItem){const u=n[n.length-1],c=u&&P(u,{level:l.level||1});if(c&&c.listItem===l.listItem){r=c,r.children.push(l);continue}else{r=_(l,i,t),n.push(r);continue}}console.warn("Unknown state encountered for block",l),n.push(l)}}return n}function ce(e,t){return(e.level||1)===t.level&&e.listItem===t.listItem}function _(e,t,n){return{_type:"@list",_key:`${e._key||`${t}`}-parent`,mode:n,level:e.level||1,listItem:e.listItem,children:[e]}}function P(e,t){const n=t.level||1,r=t.listItem||"normal",i=typeof t.listItem=="string";if(C(e)&&(e.level||1)===n&&i&&(e.listItem||"normal")===r)return e;if(!("children"in e))return;const l=e.children[e.children.length-1];return l&&!I(l)?P(l,t):void 0}function W(e){let t="";return e.children.forEach(n=>{K(n)?t+=n.text:F(n)&&(t+=W(n))}),t}const ue="html",me=["block","list","listItem","marks","types"],de=["listItem"],pe=["_key"];function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?B(Object(n),!0).forEach(function(r){fe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function fe(e,t,n){return(t=ye(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ye(e){var t=xe(e,"string");return typeof t=="symbol"?t:t+""}function xe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function O(e,t){if(e==null)return{};var n,r,i=he(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function he(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}const ge={number:({children:e})=>s.jsx("ol",{children:e}),bullet:({children:e})=>s.jsx("ul",{children:e})},je=({children:e})=>s.jsx("li",{children:e}),ke=({children:e,value:t})=>s.jsx("a",{href:t==null?void 0:t.href,children:e}),be={textDecoration:"underline"},ve={em:({children:e})=>s.jsx("em",{children:e}),strong:({children:e})=>s.jsx("strong",{children:e}),code:({children:e})=>s.jsx("code",{children:e}),underline:({children:e})=>s.jsx("span",{style:be,children:e}),"strike-through":({children:e})=>s.jsx("del",{children:e}),link:ke},N=(e,t)=>`[@portabletext/react] Unknown ${e}, specify a component for it in the \`components.${t}\` prop`,z=e=>N(`block type "${e}"`,"types"),we=e=>N(`mark type "${e}"`,"marks"),Ne=e=>N(`block style "${e}"`,"block"),_e=e=>N(`list style "${e}"`,"list"),Ie=e=>N(`list item style "${e}"`,"listItem");function Pe(e){console.warn(e)}const $={display:"none"},Oe=({value:e,isInline:t})=>{const n=z(e._type);return t?s.jsx("span",{style:$,children:n}):s.jsx("div",{style:$,children:n})},Te=({markType:e,children:t})=>s.jsx("span",{className:`unknown__pt__mark__${e}`,children:t}),Se=({children:e})=>s.jsx("p",{children:e}),Le=({children:e})=>s.jsx("ul",{children:e}),De=({children:e})=>s.jsx("li",{children:e}),Be=()=>s.jsx("br",{}),$e={normal:({children:e})=>s.jsx("p",{children:e}),blockquote:({children:e})=>s.jsx("blockquote",{children:e}),h1:({children:e})=>s.jsx("h1",{children:e}),h2:({children:e})=>s.jsx("h2",{children:e}),h3:({children:e})=>s.jsx("h3",{children:e}),h4:({children:e})=>s.jsx("h4",{children:e}),h5:({children:e})=>s.jsx("h5",{children:e}),h6:({children:e})=>s.jsx("h6",{children:e})},R={types:{},block:$e,marks:ve,list:ge,listItem:je,hardBreak:Be,unknownType:Oe,unknownMark:Te,unknownList:Le,unknownListItem:De,unknownBlockStyle:Se};function Re(e,t){const{block:n,list:r,listItem:i,marks:l,types:u}=t,c=O(t,me);return g(g({},e),{},{block:w(e,t,"block"),list:w(e,t,"list"),listItem:w(e,t,"listItem"),marks:w(e,t,"marks"),types:w(e,t,"types")},c)}function w(e,t,n){const r=t[n],i=e[n];return typeof r=="function"||r&&typeof i=="function"?r:r?g(g({},i),r):i}function H({value:e,components:t,listNestingMode:n,onMissingComponent:r=Pe}){const i=r||Me,l=Array.isArray(e)?e:[e],u=oe(l,n||ue),c=b.useMemo(()=>t?Re(R,t):R,[t]),x=b.useMemo(()=>Ee(c,i),[c,i]),j=u.map((k,a)=>x({node:k,index:a,isInline:!1,renderNode:x}));return s.jsx(s.Fragment,{children:j})}const Ee=(e,t)=>{function n(a){const{node:o,index:m,isInline:p}=a,d=o._key||`node-${m}`;return C(o)?l(o,m,d):U(o)?i(o,m,d):F(o)?u(o,m,d):r(o)?k(o,m,d,p):A(o)?c(o,m,d,p):K(o)?x(o,d):j(o,m,d,p)}function r(a){return a._type in e.types}function i(a,o,m){const p=E({node:a,index:o,isInline:!1,renderNode:n}),d=e.listItem,y=(typeof d=="function"?d:d[a.listItem])||e.unknownListItem;if(y===e.unknownListItem){const h=a.listItem||"bullet";t(Ie(h),{type:h,nodeType:"listItemStyle"})}let f=p.children;if(a.style&&a.style!=="normal"){const{listItem:h}=a,v=O(a,de);f=n({node:v,index:o,isInline:!1})}return s.jsx(y,{value:a,index:o,isInline:!1,renderNode:n,children:f},m)}function l(a,o,m){const p=a.children.map((f,h)=>n({node:f._key?f:g(g({},f),{},{_key:`li-${o}-${h}`}),index:h,isInline:!1})),d=e.list,y=(typeof d=="function"?d:d[a.listItem])||e.unknownList;if(y===e.unknownList){const f=a.listItem||"bullet";t(_e(f),{nodeType:"listStyle",type:f})}return s.jsx(y,{value:a,index:o,isInline:!1,renderNode:n,children:p},m)}function u(a,o,m){const{markDef:p,markType:d,markKey:y}=a,f=e.marks[d]||e.unknownMark,h=a.children.map((v,V)=>n({node:v,index:V,isInline:!0}));return f===e.unknownMark&&t(we(d),{nodeType:"mark",type:d}),s.jsx(f,{text:W(a),value:p,markType:d,markKey:y,renderNode:n,children:h},m)}function c(a,o,m,p){const d=E({node:a,index:o,isInline:p,renderNode:n}),{_key:y}=d,f=O(d,pe),h=f.node.style||"normal",v=(typeof e.block=="function"?e.block:e.block[h])||e.unknownBlockStyle;return v===e.unknownBlockStyle&&t(Ne(h),{nodeType:"blockStyle",type:h}),s.jsx(v,g(g({},f),{},{value:f.node,renderNode:n}),m)}function x(a,o){if(a.text===`
`){const m=e.hardBreak;return m?s.jsx(m,{},o):`
`}return a.text}function j(a,o,m,p){const d={value:a,isInline:p,index:o,renderNode:n};t(z(a._type),{nodeType:"block",type:a._type});const y=e.unknownType;return s.jsx(y,g({},d),m)}function k(a,o,m,p){const d={value:a,isInline:p,index:o,renderNode:n},y=e.types[a._type];return y?s.jsx(y,g({},d),m):null}return n};function E(e){const{node:t,index:n,isInline:r,renderNode:i}=e,l=ae(t).map((u,c)=>i({node:u,isInline:!0,index:c,renderNode:i}));return{_key:t._key||`block-${n}`,children:l,index:n,isInline:r,node:t}}function Me(){}const q={types:{image:({value:e})=>s.jsxs("div",{className:"my-6",children:[s.jsx("img",{src:T(e).width(800).url(),alt:e.alt||"Image de recette",className:"rounded-lg mx-auto"}),e.caption&&s.jsx("p",{className:"text-center text-sm text-gray-600 mt-2",children:e.caption})]})},marks:{link:({children:e,value:t})=>{const n=t.href.startsWith("/")?void 0:"noreferrer noopener";return s.jsx("a",{href:t.href,rel:n,target:n?"_blank":void 0,className:"text-red-700 hover:underline",children:e})}}},Ae=({steps:e,colSpan:t})=>{if(!e||e.length===0)return null;const n=r=>r?typeof r=="string"?s.jsx("div",{className:"ml-8 text-gray-700 dark:text-gray-300",children:r}):Array.isArray(r)?s.jsx("div",{className:"ml-8 text-gray-700 dark:text-gray-300",children:s.jsx(H,{value:r,components:q})}):null:null;return s.jsxs("div",{className:t,children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Préparation"}),s.jsx("div",{className:"space-y-6",children:e.map((r,i)=>s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx("div",{className:"bg-red-700 text-white w-6 h-6 rounded-full flex items-center justify-center mr-2",children:i+1}),s.jsx("h3",{className:"font-medium text-lg",children:r.title})]}),n(r.description),r.image&&s.jsx("div",{className:"mt-3 ml-8",children:s.jsx("img",{src:T(r.image).width(600).url(),alt:`Étape ${i+1}`,className:"rounded-md"})})]},i))})]})},Ue=({body:e,colSpan:t})=>e?s.jsxs("div",{className:t,children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Préparation"}),s.jsx("div",{className:"prose prose-lg dark:prose-invert max-w-none",children:s.jsx(H,{value:e,components:q})})]}):null,Ce=({mainImage:e,title:t})=>s.jsxs(s.Fragment,{children:[s.jsxs(M,{to:"/recipes",className:"text-red-700 hover:underline mb-6 inline-flex items-center",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Toutes les recettes"]}),e&&s.jsx("div",{className:"mb-8 max-w-3xl mx-auto",children:s.jsx("img",{src:T(e).width(800).url(),alt:t,className:"w-full h-auto rounded-lg shadow-md"})})]}),Fe=({message:e="La recette que vous recherchez n'existe pas."})=>s.jsxs("div",{className:"min-h-screen pt-32 pb-20 container-custom",children:[s.jsx("h1",{className:"text-3xl font-semibold mb-4",children:"Recette introuvable"}),s.jsx("p",{children:e}),s.jsx(M,{to:"/recipes",className:"text-red-700 hover:underline mt-4 inline-block",children:"Retour aux recettes"})]});function Je(){const{slug:e}=Y(),{recipe:t,loading:n,error:r}=Z(e);if(b.useEffect(()=>{window.scrollTo(0,0)},[]),n)return s.jsx("div",{className:"min-h-screen pt-32 pb-20 flex justify-center items-start",children:s.jsx(J,{size:"md"})});if(r||!t)return s.jsx(Fe,{message:r||void 0});const i=t.ingredients&&t.ingredients.length>0?"lg:col-span-2":"lg:col-span-3";return s.jsxs(s.Fragment,{children:[s.jsx(Q,{title:t.title,description:t.description||"Une recette délicieuse à préparer avec nos produits de qualité."}),s.jsxs("div",{className:"container-custom py-10",children:[s.jsx(Ce,{mainImage:t.mainImage,title:t.title}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8",children:[s.jsx(ee,{title:t.title,publishedAt:t.publishedAt,prepTime:t.prepTime,cookTime:t.cookTime,servings:t.servings}),t.description&&s.jsx("div",{className:"mb-8",children:s.jsx("p",{className:"text-lg italic text-gray-700 dark:text-gray-300",children:t.description})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.ingredients&&t.ingredients.length>0&&s.jsx(te,{ingredients:t.ingredients}),t.steps&&t.steps.length>0?s.jsx(Ae,{steps:t.steps,colSpan:i}):t.body?s.jsx(Ue,{body:t.body,colSpan:i}):s.jsx("div",{className:i,children:s.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Aucune instruction disponible pour cette recette."})})]})]})]})]})}export{Je as default};
