import{j as e,f as r,g as s,X as t,m as a}from"./ui-vendor.JalVFfQ9.js";import{P as l}from"./PageHeader.NtosuRjp.js";import{r as i,L as o}from"./react-vendor.pFVYCVC2.js";import{u as n,b as c,L as m}from"./index.kDMhJFkA.js";import{u as d}from"./useFormatDate.BDUOTk8q.js";import"./i18n-vendor.BK02QeAD.js";const u=({filters:l,onFilterChange:o,maxPossiblePrepTime:n,maxPossibleCookTime:c,maxPossibleServings:m,countries:d})=>{var u;const[x,g]=i.useState(!1);return e.jsxs("div",{className:"mb-8 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Rechercher des recettes...",value:l.search,onChange:e=>{o({...l,search:e.target.value})},className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),e.jsx(r,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("button",{onClick:()=>g(!x),className:"flex items-center text-sm font-medium text-primary-600 dark:text-primary-400",children:[e.jsx(s,{className:"h-4 w-4 mr-1"}),x?"Masquer les filtres":"Afficher les filtres"]}),(l.search||null!==l.maxPrepTime||null!==l.maxCookTime||null!==l.servings||null!==l.country||"date-desc"!==l.sortBy)&&e.jsxs("button",{onClick:()=>{o({search:"",maxPrepTime:null,maxCookTime:null,servings:null,country:null,sortBy:"date-desc"})},className:"flex items-center text-sm font-medium text-red-600 dark:text-red-400",children:[e.jsx(t,{className:"h-4 w-4 mr-1"}),"Effacer les filtres"]})]}),x&&e.jsx(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Temps de préparation max (min)"}),e.jsx("input",{type:"number",min:1,max:n,value:l.maxPrepTime??"",onChange:e=>{const r=""===e.target.value?null:Number(e.target.value);o({...l,maxPrepTime:r})},placeholder:"Tous",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Temps de cuisson max (min)"}),e.jsx("input",{type:"number",min:1,max:c,value:l.maxCookTime??"",onChange:e=>{const r=""===e.target.value?null:Number(e.target.value);o({...l,maxCookTime:r})},placeholder:"Tous",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre de personnes"}),e.jsxs("select",{value:(null==(u=l.servings)?void 0:u.toString())||"all",onChange:e=>{const r="all"===e.target.value?null:Number(e.target.value);o({...l,servings:r})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"all",children:"Tous"}),[...Array(m)].map(((r,s)=>e.jsxs("option",{value:s+1,children:[s+1," personne",s>0?"s":""]},s+1)))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pays d'origine"}),e.jsxs("select",{value:l.country||"all",onChange:e=>{const r="all"===e.target.value?null:e.target.value;o({...l,country:r})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"all",children:"Tous les pays"}),d.map((r=>e.jsx("option",{value:r,children:r},r)))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Trier par"}),e.jsxs("select",{value:l.sortBy,onChange:e=>{o({...l,sortBy:e.target.value})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"date-desc",children:"Plus récents d'abord"}),e.jsx("option",{value:"date-asc",children:"Plus anciens d'abord"}),e.jsx("option",{value:"prepTime-asc",children:"Préparation plus courte"}),e.jsx("option",{value:"cookTime-asc",children:"Cuisson plus courte"})]})]})]})})]})};function x({recipe:r}){const{formatDate:s}=d();return e.jsxs(o,{to:`/recipes/${r.slug.current}`,className:"group bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow flex flex-col h-full",children:[r.mainImage?e.jsx("div",{className:"h-56 overflow-hidden",children:e.jsx("img",{src:n(r.mainImage).width(600).height(400).url(),alt:r.title,className:"w-full h-full object-cover transition-transform group-hover:scale-105"})}):e.jsx("div",{className:"h-56 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400",children:"Image non disponible"})}),e.jsxs("div",{className:"p-5 flex-grow flex flex-col",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2 group-hover:text-red-700 transition-colors",children:r.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm mb-4 line-clamp-3 flex-grow",children:r.description||"Découvrez cette délicieuse recette traditionnelle..."}),e.jsxs("div",{className:"flex justify-between items-center mt-auto",children:[e.jsx("span",{className:"text-xs text-gray-500",children:s(r.publishedAt)}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[r.prepTime&&e.jsxs("span",{className:"flex items-center gap-1",title:"Temps de préparation",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.prepTime," min"]}),r.cookTime&&e.jsxs("span",{className:"flex items-center gap-1",title:"Temps de cuisson",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r.cookTime," min"]}),r.servings&&e.jsxs("span",{className:"flex items-center gap-1",title:"Nombre de personnes",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.318l-1.318 2.637L8 7.473l2.318 2.159L9.82 12 12 10.342 14.18 12l-.498-2.368L16 7.473l-2.682-.518L12 4.318z"})}),r.servings]})]})]})]})]})}function g({recipes:r}){return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.map((r=>e.jsx(x,{recipe:r},r._id)))})}function p({onReset:r}){return e.jsxs("div",{className:"text-center py-20",children:[e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:"Aucune recette trouvée avec les critères sélectionnés."}),e.jsx("button",{onClick:r,className:"mt-4 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Réinitialiser les filtres"})]})}function h(){const{recipes:r,loading:s,maxValues:t}=(()=>{const[e,r]=i.useState([]),[s,t]=i.useState(!0);i.useEffect((()=>{(async()=>{t(!0);try{const e=await c();r(e)}catch(e){}finally{t(!1)}})()}),[]);const a=i.useMemo((()=>0===e.length?{prepTime:120,cookTime:180,servings:8}:{prepTime:Math.max(...e.filter((e=>e.prepTime)).map((e=>e.prepTime||0))),cookTime:Math.max(...e.filter((e=>e.cookTime)).map((e=>e.cookTime||0))),servings:Math.max(...e.filter((e=>e.servings)).map((e=>e.servings||0)))}),[e]);return{recipes:e,loading:s,maxValues:a}})(),{filters:a,filteredRecipes:o,handleFilterChange:n,resetFilters:d,uniqueCountries:x}=(e=>{const[r,s]=i.useState({search:"",maxPrepTime:null,maxCookTime:null,servings:null,country:null,sortBy:"date-desc"}),t=i.useMemo((()=>{const r=e.map((e=>e.country)).filter((e=>!!e));return[...new Set(r)].sort()}),[e]),a=i.useMemo((()=>{let s=[...e];if(r.search){const e=r.search.toLowerCase();s=s.filter((r=>{var s;return r.title.toLowerCase().includes(e)||(null==(s=r.description)?void 0:s.toLowerCase().includes(e))}))}switch(null!==r.maxPrepTime&&(s=s.filter((e=>void 0!==e.prepTime&&e.prepTime<=r.maxPrepTime))),null!==r.maxCookTime&&(s=s.filter((e=>void 0!==e.cookTime&&e.cookTime<=r.maxCookTime))),null!==r.servings&&(s=s.filter((e=>e.servings===r.servings))),null!==r.country&&""!==r.country&&(s=s.filter((e=>e.country&&e.country.toLowerCase()===r.country.toLowerCase()))),r.sortBy){case"date-desc":s.sort(((e,r)=>new Date(r.publishedAt).getTime()-new Date(e.publishedAt).getTime()));break;case"date-asc":s.sort(((e,r)=>new Date(e.publishedAt).getTime()-new Date(r.publishedAt).getTime()));break;case"prepTime-asc":s.sort(((e,r)=>(e.prepTime||Number.MAX_SAFE_INTEGER)-(r.prepTime||Number.MAX_SAFE_INTEGER)));break;case"cookTime-asc":s.sort(((e,r)=>(e.cookTime||Number.MAX_SAFE_INTEGER)-(r.cookTime||Number.MAX_SAFE_INTEGER)))}return s}),[e,r]);return{filters:r,filteredRecipes:a,handleFilterChange:e=>{s(e)},resetFilters:()=>{s({search:"",maxPrepTime:null,maxCookTime:null,servings:null,country:null,sortBy:"date-desc"})},uniqueCountries:t}})(r);return e.jsxs(e.Fragment,{children:[e.jsx(l,{title:"Nos Recettes",description:"Découvrez nos suggestions de recettes pour sublimer nos produits."}),e.jsxs("div",{className:"container-custom py-10",children:[e.jsx(u,{filters:a,onFilterChange:n,maxPossiblePrepTime:t.prepTime,maxPossibleCookTime:t.cookTime,maxPossibleServings:t.servings,countries:x}),s?e.jsx(m,{}):o.length>0?e.jsx(g,{recipes:o}):e.jsx(p,{onReset:d})]})]})}export{h as default};
