import{r as g,j as e,X as k,m as j,e as f,a as T,f as w,L as N}from"./index.BcsZm8ZK.js";import{P as C}from"./PageHeader.DDR5ggh0.js";import{S as R,a as P}from"./sliders-horizontal.BgAOeMv-.js";import{u as A}from"./useFormatDate.6mQ2QUux.js";const S=({filters:s,onFilterChange:r,maxPossiblePrepTime:c,maxPossibleCookTime:m,maxPossibleServings:u,countries:o})=>{var p;const[d,a]=g.useState(!1),t=l=>{r({...s,search:l.target.value})},n=l=>{const i=l.target.value===""?null:Number(l.target.value);r({...s,maxPrepTime:i})},x=l=>{const i=l.target.value===""?null:Number(l.target.value);r({...s,maxCookTime:i})},h=l=>{const i=l.target.value==="all"?null:Number(l.target.value);r({...s,servings:i})},y=l=>{const i=l.target.value==="all"?null:l.target.value;r({...s,country:i})},b=l=>{r({...s,sortBy:l.target.value})},v=()=>{r({search:"",maxPrepTime:null,maxCookTime:null,servings:null,country:null,sortBy:"date-desc"})};return e.jsxs("div",{className:"mb-8 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Rechercher des recettes...",value:s.search,onChange:t,className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),e.jsx(R,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("button",{onClick:()=>a(!d),className:"flex items-center text-sm font-medium text-primary-600 dark:text-primary-400",children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),d?"Masquer les filtres":"Afficher les filtres"]}),(s.search||s.maxPrepTime!==null||s.maxCookTime!==null||s.servings!==null||s.country!==null||s.sortBy!=="date-desc")&&e.jsxs("button",{onClick:v,className:"flex items-center text-sm font-medium text-red-600 dark:text-red-400",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"Effacer les filtres"]})]}),d&&e.jsx(j.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Temps de préparation max (min)"}),e.jsx("input",{type:"number",min:1,max:c,value:s.maxPrepTime??"",onChange:n,placeholder:"Tous",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Temps de cuisson max (min)"}),e.jsx("input",{type:"number",min:1,max:m,value:s.maxCookTime??"",onChange:x,placeholder:"Tous",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre de personnes"}),e.jsxs("select",{value:((p=s.servings)==null?void 0:p.toString())||"all",onChange:h,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"all",children:"Tous"}),[...Array(u)].map((l,i)=>e.jsxs("option",{value:i+1,children:[i+1," personne",i>0?"s":""]},i+1))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pays d'origine"}),e.jsxs("select",{value:s.country||"all",onChange:y,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"all",children:"Tous les pays"}),o.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Trier par"}),e.jsxs("select",{value:s.sortBy,onChange:b,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"date-desc",children:"Plus récents d'abord"}),e.jsx("option",{value:"date-asc",children:"Plus anciens d'abord"}),e.jsx("option",{value:"prepTime-asc",children:"Préparation plus courte"}),e.jsx("option",{value:"cookTime-asc",children:"Cuisson plus courte"})]})]})]})})]})};function E({recipe:s}){const{formatDate:r}=A();return e.jsxs(f,{to:`/recipes/${s.slug.current}`,className:"group bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow flex flex-col h-full",children:[s.mainImage?e.jsx("div",{className:"h-56 overflow-hidden",children:e.jsx("img",{src:T(s.mainImage).width(600).height(400).url(),alt:s.title,className:"w-full h-full object-cover transition-transform group-hover:scale-105"})}):e.jsx("div",{className:"h-56 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400",children:"Image non disponible"})}),e.jsxs("div",{className:"p-5 flex-grow flex flex-col",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2 group-hover:text-red-700 transition-colors",children:s.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm mb-4 line-clamp-3 flex-grow",children:s.description||"Découvrez cette délicieuse recette traditionnelle..."}),e.jsxs("div",{className:"flex justify-between items-center mt-auto",children:[e.jsx("span",{className:"text-xs text-gray-500",children:r(s.publishedAt)}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[s.prepTime&&e.jsxs("span",{className:"flex items-center gap-1",title:"Temps de préparation",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.prepTime," min"]}),s.cookTime!==void 0&&e.jsxs("span",{className:"flex items-center gap-1",title:"Temps de cuisson",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"})}),s.cookTime," min"]}),s.servings&&e.jsxs("span",{className:"flex items-center gap-1",title:"Nombre de personnes",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),s.servings]})]})]})]})]})}function L({recipes:s}){return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:s.map(r=>e.jsx(E,{recipe:r},r._id))})}function M({onReset:s}){return e.jsxs("div",{className:"text-center py-20",children:[e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:"Aucune recette trouvée avec les critères sélectionnés."}),e.jsx("button",{onClick:s,className:"mt-4 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Réinitialiser les filtres"})]})}const F=()=>{const[s,r]=g.useState([]),[c,m]=g.useState(!0);g.useEffect(()=>{(async()=>{m(!0);try{const d=await w();r(d)}catch(d){console.error("Error fetching recipes:",d)}finally{m(!1)}})()},[]);const u=g.useMemo(()=>s.length===0?{prepTime:120,cookTime:180,servings:8}:{prepTime:Math.max(...s.filter(o=>o.prepTime).map(o=>o.prepTime||0)),cookTime:Math.max(...s.filter(o=>o.cookTime).map(o=>o.cookTime||0)),servings:Math.max(...s.filter(o=>o.servings).map(o=>o.servings||0))},[s]);return{recipes:s,loading:c,maxValues:u}},B=s=>{const[r,c]=g.useState({search:"",maxPrepTime:null,maxCookTime:null,servings:null,country:null,sortBy:"date-desc"}),m=g.useMemo(()=>{const a=s.map(t=>t.country).filter(t=>!!t);return[...new Set(a)].sort()},[s]),u=g.useMemo(()=>{let a=[...s];if(r.search){const t=r.search.toLowerCase();a=a.filter(n=>{var x;return n.title.toLowerCase().includes(t)||((x=n.description)==null?void 0:x.toLowerCase().includes(t))})}switch(r.maxPrepTime!==null&&(a=a.filter(t=>t.prepTime!==void 0&&t.prepTime<=r.maxPrepTime)),r.maxCookTime!==null&&(a=a.filter(t=>t.cookTime!==void 0&&t.cookTime<=r.maxCookTime)),r.servings!==null&&(a=a.filter(t=>t.servings===r.servings)),r.country!==null&&r.country!==""&&(a=a.filter(t=>t.country&&t.country.toLowerCase()===r.country.toLowerCase())),r.sortBy){case"date-desc":a.sort((t,n)=>new Date(n.publishedAt).getTime()-new Date(t.publishedAt).getTime());break;case"date-asc":a.sort((t,n)=>new Date(t.publishedAt).getTime()-new Date(n.publishedAt).getTime());break;case"prepTime-asc":a.sort((t,n)=>{const x=t.prepTime||Number.MAX_SAFE_INTEGER,h=n.prepTime||Number.MAX_SAFE_INTEGER;return x-h});break;case"cookTime-asc":a.sort((t,n)=>{const x=t.cookTime||Number.MAX_SAFE_INTEGER,h=n.cookTime||Number.MAX_SAFE_INTEGER;return x-h});break}return a},[s,r]);return{filters:r,filteredRecipes:u,handleFilterChange:a=>{c(a)},resetFilters:()=>{c({search:"",maxPrepTime:null,maxCookTime:null,servings:null,country:null,sortBy:"date-desc"})},uniqueCountries:m}};function G(){const{recipes:s,loading:r,maxValues:c}=F(),{filters:m,filteredRecipes:u,handleFilterChange:o,resetFilters:d,uniqueCountries:a}=B(s);return e.jsxs(e.Fragment,{children:[e.jsx(C,{title:"Nos Recettes",description:"Découvrez nos suggestions de recettes pour sublimer nos produits."}),e.jsxs("div",{className:"container-custom py-10",children:[e.jsx(S,{filters:m,onFilterChange:o,maxPossiblePrepTime:c.prepTime,maxPossibleCookTime:c.cookTime,maxPossibleServings:c.servings,countries:a}),r?e.jsx(N,{}):u.length>0?e.jsx(L,{recipes:u}):e.jsx(M,{onReset:d})]})]})}export{G as default};
