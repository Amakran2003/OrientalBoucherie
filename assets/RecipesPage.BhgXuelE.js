import{r as e,j as r,L as s}from"./react-vendor.esZCIC4a.js";import{P as t}from"./PageHeader.DANmZ3fA.js";import{f as a,g as i,X as l,m as o}from"./ui-vendor.9VPgCtJx.js";import{u as n,b as c,L as d}from"./index.CFCwS9l9.js";import{u as m}from"./useFormatDate.BDUOTk8q.js";import"./vendor.C6ZqhxWp.js";import"./i18n-vendor.DFFi2l9K.js";const u=({filters:s,onFilterChange:t,maxPossiblePrepTime:n,maxPossibleCookTime:c,maxPossibleServings:d,countries:m})=>{var u;const[x,g]=e.useState(!1);return r.jsxs("div",{className:"mb-8 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[r.jsxs("div",{className:"relative mb-4",children:[r.jsx("input",{type:"text",placeholder:"Rechercher des recettes...",value:s.search,onChange:e=>{t({...s,search:e.target.value})},className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),r.jsx(a,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]}),r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("button",{onClick:()=>g(!x),className:"flex items-center text-sm font-medium text-primary-600 dark:text-primary-400",children:[r.jsx(i,{className:"h-4 w-4 mr-1"}),x?"Masquer les filtres":"Afficher les filtres"]}),(s.search||null!==s.maxPrepTime||null!==s.maxCookTime||null!==s.servings||null!==s.country||"date-desc"!==s.sortBy)&&r.jsxs("button",{onClick:()=>{t({search:"",maxPrepTime:null,maxCookTime:null,servings:null,country:null,sortBy:"date-desc"})},className:"flex items-center text-sm font-medium text-red-600 dark:text-red-400",children:[r.jsx(l,{className:"h-4 w-4 mr-1"}),"Effacer les filtres"]})]}),x&&r.jsx(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Temps de préparation max (min)"}),r.jsx("input",{type:"number",min:1,max:n,value:s.maxPrepTime??"",onChange:e=>{const r=""===e.target.value?null:Number(e.target.value);t({...s,maxPrepTime:r})},placeholder:"Tous",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Temps de cuisson max (min)"}),r.jsx("input",{type:"number",min:1,max:c,value:s.maxCookTime??"",onChange:e=>{const r=""===e.target.value?null:Number(e.target.value);t({...s,maxCookTime:r})},placeholder:"Tous",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre de personnes"}),r.jsxs("select",{value:(null==(u=s.servings)?void 0:u.toString())||"all",onChange:e=>{const r="all"===e.target.value?null:Number(e.target.value);t({...s,servings:r})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[r.jsx("option",{value:"all",children:"Tous"}),[...Array(d)].map(((e,s)=>r.jsxs("option",{value:s+1,children:[s+1," personne",s>0?"s":""]},s+1)))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pays d'origine"}),r.jsxs("select",{value:s.country||"all",onChange:e=>{const r="all"===e.target.value?null:e.target.value;t({...s,country:r})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[r.jsx("option",{value:"all",children:"Tous les pays"}),m.map((e=>r.jsx("option",{value:e,children:e},e)))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Trier par"}),r.jsxs("select",{value:s.sortBy,onChange:e=>{t({...s,sortBy:e.target.value})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[r.jsx("option",{value:"date-desc",children:"Plus récents d'abord"}),r.jsx("option",{value:"date-asc",children:"Plus anciens d'abord"}),r.jsx("option",{value:"prepTime-asc",children:"Préparation plus courte"}),r.jsx("option",{value:"cookTime-asc",children:"Cuisson plus courte"})]})]})]})})]})};function x({recipe:e}){const{formatDate:t}=m();return r.jsxs(s,{to:`/recipes/${e.slug.current}`,className:"group bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow flex flex-col h-full",children:[e.mainImage?r.jsx("div",{className:"h-56 overflow-hidden",children:r.jsx("img",{src:n(e.mainImage).width(600).height(400).url(),alt:e.title,className:"w-full h-full object-cover transition-transform group-hover:scale-105"})}):r.jsx("div",{className:"h-56 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:r.jsx("span",{className:"text-gray-400",children:"Image non disponible"})}),r.jsxs("div",{className:"p-5 flex-grow flex flex-col",children:[r.jsx("h2",{className:"text-xl font-semibold mb-2 group-hover:text-red-700 transition-colors",children:e.title}),r.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm mb-4 line-clamp-3 flex-grow",children:e.description||"Découvrez cette délicieuse recette traditionnelle..."}),r.jsxs("div",{className:"flex justify-between items-center mt-auto",children:[r.jsx("span",{className:"text-xs text-gray-500",children:t(e.publishedAt)}),r.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.prepTime&&r.jsxs("span",{className:"flex items-center gap-1",title:"Temps de préparation",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.prepTime," min"]}),void 0!==e.cookTime&&r.jsxs("span",{className:"flex items-center gap-1",title:"Temps de cuisson",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"})}),e.cookTime," min"]}),e.servings&&r.jsxs("span",{className:"flex items-center gap-1",title:"Nombre de personnes",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),e.servings]})]})]})]})]})}function g({recipes:e}){return r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:e.map((e=>r.jsx(x,{recipe:e},e._id)))})}function p({onReset:e}){return r.jsxs("div",{className:"text-center py-20",children:[r.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:"Aucune recette trouvée avec les critères sélectionnés."}),r.jsx("button",{onClick:e,className:"mt-4 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Réinitialiser les filtres"})]})}function h(){const{recipes:s,loading:a,maxValues:i}=(()=>{const[r,s]=e.useState([]),[t,a]=e.useState(!0);e.useEffect((()=>{(async()=>{a(!0);try{const e=await c();s(e)}catch(e){}finally{a(!1)}})()}),[]);const i=e.useMemo((()=>0===r.length?{prepTime:120,cookTime:180,servings:8}:{prepTime:Math.max(...r.filter((e=>e.prepTime)).map((e=>e.prepTime||0))),cookTime:Math.max(...r.filter((e=>e.cookTime)).map((e=>e.cookTime||0))),servings:Math.max(...r.filter((e=>e.servings)).map((e=>e.servings||0)))}),[r]);return{recipes:r,loading:t,maxValues:i}})(),{filters:l,filteredRecipes:o,handleFilterChange:n,resetFilters:m,uniqueCountries:x}=(r=>{const[s,t]=e.useState({search:"",maxPrepTime:null,maxCookTime:null,servings:null,country:null,sortBy:"date-desc"}),a=e.useMemo((()=>{const e=r.map((e=>e.country)).filter((e=>!!e));return[...new Set(e)].sort()}),[r]),i=e.useMemo((()=>{let e=[...r];if(s.search){const r=s.search.toLowerCase();e=e.filter((e=>{var s;return e.title.toLowerCase().includes(r)||(null==(s=e.description)?void 0:s.toLowerCase().includes(r))}))}switch(null!==s.maxPrepTime&&(e=e.filter((e=>void 0!==e.prepTime&&e.prepTime<=s.maxPrepTime))),null!==s.maxCookTime&&(e=e.filter((e=>void 0!==e.cookTime&&e.cookTime<=s.maxCookTime))),null!==s.servings&&(e=e.filter((e=>e.servings===s.servings))),null!==s.country&&""!==s.country&&(e=e.filter((e=>e.country&&e.country.toLowerCase()===s.country.toLowerCase()))),s.sortBy){case"date-desc":e.sort(((e,r)=>new Date(r.publishedAt).getTime()-new Date(e.publishedAt).getTime()));break;case"date-asc":e.sort(((e,r)=>new Date(e.publishedAt).getTime()-new Date(r.publishedAt).getTime()));break;case"prepTime-asc":e.sort(((e,r)=>(e.prepTime||Number.MAX_SAFE_INTEGER)-(r.prepTime||Number.MAX_SAFE_INTEGER)));break;case"cookTime-asc":e.sort(((e,r)=>(e.cookTime||Number.MAX_SAFE_INTEGER)-(r.cookTime||Number.MAX_SAFE_INTEGER)))}return e}),[r,s]);return{filters:s,filteredRecipes:i,handleFilterChange:e=>{t(e)},resetFilters:()=>{t({search:"",maxPrepTime:null,maxCookTime:null,servings:null,country:null,sortBy:"date-desc"})},uniqueCountries:a}})(s);return r.jsxs(r.Fragment,{children:[r.jsx(t,{title:"Nos Recettes",description:"Découvrez nos suggestions de recettes pour sublimer nos produits."}),r.jsxs("div",{className:"container-custom py-10",children:[r.jsx(u,{filters:l,onFilterChange:n,maxPossiblePrepTime:i.prepTime,maxPossibleCookTime:i.cookTime,maxPossibleServings:i.servings,countries:x}),a?r.jsx(d,{}):o.length>0?r.jsx(g,{recipes:o}):r.jsx(p,{onReset:m})]})]})}export{h as default};
